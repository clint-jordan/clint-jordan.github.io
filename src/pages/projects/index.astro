---
import Layout from "../../layouts/Layout.astro";
import Section from "../../components/common/Section.astro";
import ProjectSnippet from "../../components/PostSnippet.astro";
import { getCollection } from "astro:content";
import { siteConfig } from "../../site.config"
import ContentHeader from "../../components/common/ContentHeader.astro";
import SEO from "../../components/common/SEO.astro";

const config = siteConfig;
const baseUrl = import.meta.env.BASE_URL;

const collectionName = "projects"
const posts = (await getCollection(collectionName)).map((post) => ({
  ...post.data,
  url: `${baseUrl}/${collectionName}/${post.data.slug}`,
}));
---

<Layout>
  <Fragment slot="head">
    <SEO configKey="project" />
  </Fragment>
  <Section class="my-16">
    <ContentHeader title={config.texts.projectsName} cursor={false} />
    {posts.length > 0 ? (
      <div class="space-y-8">
        {posts.map((post) => (
          <ProjectSnippet
            title={post.title}
            description={post.description}
            url={post.url}
            tags={post.tags}
            published={post.published}
            updated={post.updated}
          />
        ))}
      </div>
    ) : (
      <p>{config.texts.noPosts}</p>
    )}
  </Section>
</Layout